# TCP (Transmission Control Protocol)

## 전송 계층 (Transport Layer)
- TCP, UDP는 5 layer 중 전송 계층의 통신 프로토콜이다
- 전송계층은 End point간 신뢰성 있는 데이터 전송을 담당하는 계층이다.

### 전송계층이 없다면?
- 데이터의 순차 전송이 원활하지 않다.
- 흐름 문제 : 송수신자 간 데이터 처리 속도 차이가 존재 할 수 있으며 수신자의 데이터 한계량이 초과되어도  
송신자 측에서 데이터를 전송하려고 할 경우 데이터 누락 문제가 발생한다.
- 혼잡 문제 : 네트워크 데이터 처리 속도에 의해서 데이터가 제대로 전송되지 않을 수 있다.

=> 데이터의 손실이 발생하고 이를 해결하기 위해 TCP가 등장한다.

## TCP(Transmission Control Protocol)
신뢰성 있는 데이터 통신을 가능하게 해주는 프로토콜이다

1. 데이터 전송단위: Segment
2. 데이터 순차 전송을 보장한다
3. 양방향 통신 (3 way handshake, 4 way handshake)
4. 흐름 제어
- 수신 측이 송신 측보다 데이터 처리 속도가 느릴 경우 데이터를 손실할 위험이 존재한다
- 송신 측과 수신 측의 데이터 처리 속도 차이로 인해 발생하는 문제를 해결하기 위한 기법이다
5. 혼잡 제어
- 혼잡 상태는 데이터의 양이 수신 측에서 처리할 수 있는 양을 초과하게 되면,  
송신 측에서는 수신 측에서 처리하지 못한 데이터를 손실 데이터로 간주하여 계속 재전송하게 되므로 네트워크가 더 혼잡해진다.  
- 네트워크가 혼잡하다고 판단될 때 송신률을 감속한다
6. 용도: HTTP, 전자우편, 파일 전송 등

### 3-way handshake
전송제어 프로토콜(TCP)에서 통신을 하는 장치 간에 서로 연결이 잘 되어있는지 확인하는 방식이다  
데이터를 주고받기 전에 서버와 클라이언트가 확인 패킷을 3단계로 교환하여 연결을 맺는다

1. SYN  
  클라이언트가 서버에 통신을 하기 위해 연결을 요청하는 단계  
  클라이언트가 연결요청 메시지(SYN)을 전송한다. 클라이언트는 Synchronize Sequence Number(SYN)라는 임의의 랜덤 숫자를 함께 전송한다
2. SYN-ACK  
  서버는 클라이언트에게 자신이 활성 상태임을 알리고 연결을 활성화하도록 요청 메세지를 제공한다   
  메시지에는 Acknowledgement number(ACK)를 포함하고 있으며 이 번호는 받은 Synchronize Sequence Number(SYN)보다 +1한 값을 갖는다
3. ACK  
  클라이언트는 서버의 요청 메세지를 수락하여 연결이 수립된다.  
  Acknowledgement number(ACK)에 받은 Sequence number +1해서 전송합니다
  
=> 양방향 커넥션이 연결되면 데이터 전송을 한다.

### TCP의 데이터 전송 과정
1. 클라이언트가 패킷을 송신한다.
2. 서버 측에서 응답을 알리기 위해 ACK를 송신한다.
3. ACK를 수신하지 못했을 경우 클라이언트가 패킷을 재전송한다.

### 4 way-handshake (연결 해제)
3 way handshake와 반대로 가상 회선 연결을 해제할 때 주고 받는 확인작업이다

1. 클라이언트 측에서 FIN 비트를 1로 설정하고 서버측에 전송한다.
2. 서버측에서 응답을 알리기 위해 ACK 를 전송한다. 서버측에서 남은 패킷을 클라이언트 측에 전송한다.
3. 서버측에서 남은 패킷을 모두 전송한 후, 클라이언트 측에 FIN을 전송한다.
4. 클라이언트 측에서 응답을 알리기 위해 ACK를 전송한다.

### TCP의 단점
1. 매번 커넥션을 연결해서 시간 손실 발생
2. 패킷을 조금만 손실해도 재전송하는 문제점  
=> TCP의 단점을 보완하기위해 나온 것이 UDP이다

# UDP (User Datagram Protocol)
비연결형, 신뢰성이 없는 전송 프로토콜

1. 수신 측에 제대로 도착했는지 확인 여부가 보장되지 않아 비신뢰성
2. 빠른 요청과 응답이 필요한 실시간 응용에 적합
3. 흐름제어를 하지 않기 때문에 전송 속도를 최대한 빠르게 할 수 있다.
4. 수신자와 송신자 간의 TCP처럼 handshaking 과정이 없음으로 비연결성 특징을 갖는다
5. 용도: DNS, 실시간 스트리밍

### 비교
- 연결방식: [TCP] 연결지향형 / [UDP] 비 연결지향형
- 패킷 교환 방식: [TCP] 가상회선 방식 / [UDP] 데이터 그램 방식
- 전송 순서: [TCP] 순서 보장 / [UDP] 순서 보장 불가
- 신뢰성: [UDP]보다 [TCP]가 더 높음
- 속도: [TCP]보다 [UDP]가 빠름
- 통신 방식: [TCP] 일대일 통신, 수신 여부 확인 / [UDP] 일대일/다대일/다대다 통신, 수신 여부를 확인하지 않음
- 수신확인: [TCP] 사용자의 요청이 있으면, 데이터 확인 및 전송, 재전송이 가능 / [UDP] 수신 확인을 하지 않고, 손실된 데이터를 다시 전송하지 않는다.
- [TCP와 UDP] 모두 오류를 검사할 수 있지만, [TCP]만 흐름 제어와 정체를 모두 가지고 있어 오류를 수정할 수 있다.

=> 따라서 신뢰성이 요구되는 애플리케이션에서는 TCP를 사용하고, 간단한 데이터를 빠른 속도로 전송하고자 하는 애플리케이션에는 UDP를 사용한다
